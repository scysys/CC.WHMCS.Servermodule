function Page(){this.changeTitlePage=function(e=RADIO_NAME){document.title=e},this.refreshCurrentSong=function(e,t){var a=document.getElementById("currentSong"),o=document.getElementById("currentArtist");e!==a.innerHTML&&(a.className="animated flipInY text-uppercase",a.innerHTML=e,o.className="animated flipInY text-capitalize",o.innerHTML=t,document.getElementById("lyricsSong").innerHTML=e+" - "+t,setTimeout(function(){a.className="text-uppercase",o.className="text-capitalize"},2e3))},this.refreshHistoric=function(e,t){var a=document.querySelectorAll("#historicSong article"),o=document.querySelectorAll("#historicSong article .music-info .song"),n=document.querySelectorAll("#historicSong article .music-info .artist"),i=DEFAULT_COVER_ART,r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var r=JSON.parse(this.responseText),s=r.resultCount?r.results[0].artworkUrl100:i;document.querySelectorAll("#historicSong article .cover-historic")[t].style.backgroundImage="url("+s+")"}var u=e.song.replace(/&apos;/g,"'"),l=u.replace(/&amp;/g,"&"),c=e.artist.replace(/&apos;/g,"'"),m=c.replace(/&amp;/g,"&");o[t].innerHTML=l,n[t].innerHTML=m,a[t].classList.add("animated"),a[t].classList.add("slideInRight")},r.open("GET","https://itunes.apple.com/search?term="+e.artist+" "+e.song+"&media=music&limit=1",!0),r.send(),setTimeout(function(){for(var e=0;e<2;e++)a[e].classList.remove("animated"),a[e].classList.remove("slideInRight")},2e3)},this.refreshCover=function(e="",t){var a=DEFAULT_COVER_ART,o=new XMLHttpRequest;o.onreadystatechange=function(){var o=document.getElementById("currentCoverArt"),n=document.getElementById("bgCover");if(4===this.readyState&&200===this.status){var i=JSON.parse(this.responseText),r=i.resultCount?i.results[0].artworkUrl100:a;a=r!=a?r.replace("100x100bb","512x512bb"):a;var s=r!=a?a.replace("512x512bb","96x96bb"):a,u=r!=a?a.replace("512x512bb","128x128bb"):a,l=r!=a?a.replace("512x512bb","192x192bb"):a,c=r!=a?a.replace("512x512bb","256x256bb"):a,m=r!=a?a.replace("512x512bb","384x384bb"):a;o.style.backgroundImage="url("+a+")",o.className="animated bounceInLeft",n.style.backgroundImage="url("+a+")",setTimeout(function(){o.className=""},2e3),"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata({title:e,artist:t,artwork:[{src:s,sizes:"96x96",type:"image/png"},{src:u,sizes:"128x128",type:"image/png"},{src:l,sizes:"192x192",type:"image/png"},{src:c,sizes:"256x256",type:"image/png"},{src:m,sizes:"384x384",type:"image/png"},{src:a,sizes:"512x512",type:"image/png"}]}))}},o.open("GET","https://itunes.apple.com/search?term="+t+" "+e+"&media=music&limit=1",!0),o.send()},this.changeVolumeIndicator=function(e){document.getElementById("volIndicator").innerHTML=e,"undefined"!=typeof Storage&&localStorage.setItem("volume",e)},this.setVolume=function(){if("undefined"!=typeof Storage){var e=localStorage.getItem("volume")?localStorage.getItem("volume"):80;document.getElementById("volume").value=e,document.getElementById("volIndicator").innerHTML=e}},this.refreshLyric=function(e,t){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var e=JSON.parse(this.responseText),t=document.getElementsByClassName("lyrics")[0];if("exact"===e.type||"aprox"===e.type){var a=e.mus[0].text;document.getElementById("lyric").innerHTML=a.replace(/\n/g,"<br />"),t.style.opacity="1",t.setAttribute("data-toggle","modal")}else{t.style.opacity="0.3",t.removeAttribute("data-toggle");var o=document.getElementById("modalLyrics");o.style.display="none",o.setAttribute("aria-hidden","true"),document.getElementsByClassName("modal-backdrop")[0]&&document.getElementsByClassName("modal-backdrop")[0].remove()}}else document.getElementsByClassName("lyrics")[0].style.opacity="0.3",document.getElementsByClassName("lyrics")[0].removeAttribute("data-toggle")},a.open("GET","https://api.vagalume.com.br/search.php?apikey="+API_KEY+"&art="+t+"&mus="+e.toLowerCase(),!0),a.send()}}function Player(){this.play=async function(){await audio.play();var e=document.getElementById("volume").value;"undefined"!=typeof Storage&&null!==localStorage.getItem("volume")?audio.volume=intToDecimal(localStorage.getItem("volume")):audio.volume=intToDecimal(e),document.getElementById("volIndicator").innerHTML=e},this.pause=function(){audio.pause()}}function togglePlay(){audio.paused?(audio.load(),audio.play()):audio.pause()}function volumeUp(){var e=audio.volume;audio&&audio.volume>=0&&audio.volume<1&&(audio.volume=(e+.01).toFixed(2))}function volumeDown(){var e=audio.volume;audio&&audio.volume>=.01&&audio.volume<=1&&(audio.volume=(e-.01).toFixed(2))}function mute(){if(audio.muted){var e=localStorage.getItem("volume");document.getElementById("volIndicator").innerHTML=e,document.getElementById("volume").value=e,audio.volume=intToDecimal(e),audio.muted=!1}else document.getElementById("volIndicator").innerHTML=0,document.getElementById("volume").value=0,audio.volume=0,audio.muted=!0}function getStreamingData(){var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4===this.readyState&&200===this.status){0===this.response.length&&console.log("%cdebug","font-size: 22px");var e=JSON.parse(this.responseText),t=new Page,a=document.getElementById("currentSong").innerHTML.replace(/&apos;/g,"'");let n=a.replace(/&amp;/g,"&"),i=e.currentSong.replace(/&apos;/g,"'"),r=i.replace(/&amp;/g,"&"),s=e.currentArtist.replace(/&apos;/g,"'"),u=s.replace(/&amp;/g,"&");if(u=u.replace("  "," "),document.title=r+" - "+u+" | "+RADIO_NAME,n.trim()!==r.trim()){t.refreshCover(r,u),t.refreshCurrentSong(r,u),t.refreshLyric(r,u);for(var o=0;o<2;o++)t.refreshHistoric(e.songHistory[o],o)}}};var t=new Date;e.open("GET","https://scripts.streampanel.net/cc/player/03/api.php?url="+URL_STREAMING+"&streamtype="+STREAMING_TYPE+"&mountpointnumber="+MOUNTPOINT_NUMBER+"&userid="+SP_USERID+"&historic="+HISTORIC+"&next="+NEXT_SONG+"&t="+t.getTime(),!0),e.send()}function intToDecimal(e){return e/100}function decimalToInt(e){return 100*e}const RADIO_NAME=settings.radio_name,URL_STREAMING=settings.url_streaming,STREAMING_TYPE=settings.streaming_type,MOUNTPOINT_NUMBER=settings.mountpoint_number,API_KEY=settings.api_key,HISTORIC=settings.historic,NEXT_SONG=settings.next_song,SP_USERID=settings.sp_userid,DEFAULT_COVER_ART=settings.default_cover_art;window.onload=function(){var e=new Page;e.changeTitlePage(),e.setVolume(),getStreamingData(),setInterval(function(){getStreamingData()},1e4);var t=document.getElementsByClassName("cover-album")[0];t.style.height=t.offsetWidth+"px"};var audio=new Audio(URL_STREAMING);audio.onplay=function(){var e=document.getElementById("playerButton");"fas fa-play"===e.className&&(e.className="fas fa-pause")},audio.onpause=function(){var e=document.getElementById("playerButton");"fas fa-pause"===e.className&&(e.className="fas fa-play")},audio.onvolumechange=function(){audio.volume>0&&(audio.muted=!1)},audio.onerror=function(){var e=confirm("Error on communicate to server. \nClick OK to try again or contact us.");e&&window.location.reload()},document.getElementById("volume").oninput=function(){audio.volume=intToDecimal(this.value);var e=new Page;e.changeVolumeIndicator(this.value)},document.addEventListener("keydown",function(e){e=e||window.event;var t=e.keyCode||e.which,a=document.getElementById("volume"),o=new Page;switch(t){case 38:volumeUp(),a.value=decimalToInt(audio.volume),o.changeVolumeIndicator(decimalToInt(audio.volume));break;case 40:volumeDown(),a.value=decimalToInt(audio.volume),o.changeVolumeIndicator(decimalToInt(audio.volume));break;case 32:case 80:togglePlay();break;case 77:mute();break;case 48:case 96:audio.volume=0,a.value=0,o.changeVolumeIndicator(0);break;case 49:case 97:audio.volume=.1,a.value=10,o.changeVolumeIndicator(10);break;case 50:case 98:audio.volume=.2,a.value=20,o.changeVolumeIndicator(20);break;case 51:case 99:audio.volume=.3,a.value=30,o.changeVolumeIndicator(30);break;case 52:case 100:audio.volume=.4,a.value=40,o.changeVolumeIndicator(40);break;case 53:case 101:audio.volume=.5,a.value=50,o.changeVolumeIndicator(50);break;case 54:case 102:audio.volume=.6,a.value=60,o.changeVolumeIndicator(60);break;case 55:case 103:audio.volume=.7,a.value=70,o.changeVolumeIndicator(70);break;case 56:case 104:audio.volume=.8,a.value=80,o.changeVolumeIndicator(80);break;case 57:case 105:audio.volume=.9,a.value=90,o.changeVolumeIndicator(90)}});